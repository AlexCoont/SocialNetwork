{"version":3,"sources":["webpack:///src/components/Im/Dialog.vue","webpack:///./src/components/Im/Dialog.vue?2f9b","webpack:///./src/components/Im/Dialog.vue","webpack:///src/components/Im/Chat.vue","webpack:///./src/components/Im/Chat.vue?3d93","webpack:///./src/components/Im/Chat.vue","webpack:///src/pages/User/Im.vue","webpack:///./src/pages/User/Im.vue?c03e","webpack:///./src/pages/User/Im.vue"],"names":["Dialog","name","props","active","Boolean","push","Number","online","me","info","Object","computed","statusText","this","moment_default","last_message","recipient","last_online_time","fromNow","Im_Dialog","render","_vm","_h","$createElement","_c","_self","staticClass","class","attrs","to","params","id","src","photo","alt","first_name","_v","_s","last_name","_e","message_text","_f","time","staticRenderFns","components_Im_Dialog","__webpack_require__","normalizeComponent","ssrContext","Chat","messages","Array","data","mes","methods","extends_default","vuex_esm","onSubmitMessage","postMessage","mounted","$refs","messageBlock","scrollTop","scrollHeight","Im_Chat","ref","_l","day","key","date","isSentByMe","action","on","submit","$event","preventDefault","directives","rawName","value","expression","type","placeholder","domProps","input","target","composing","Im","components","ImDialog","ImChat","Chat_normalizeComponent","countPush","unread","checkOnlineUser","diff","clickOnDialog","dialogId","$router","query","activeDialog","selectDialogByRoute","route","vm","switchDialog","dialogs","length","console","log","beforeRouteEnter","from","next","_ref","_this","asyncToGenerator_default","regenerator_default","a","mark","_callee","wrap","_context","prev","dialogsLoaded","apiDialogs","stop","_x","apply","arguments","beforeRouteUpdate","beforeDestroy","closeDialog","User_Im","dialog","unread_count","nativeOn","click","getMessages","Im_Component","Im_normalizeComponent","__webpack_exports__"],"mappings":"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","file":"static/js/4.07aa2e5ffa8724a3c0ad.js","sourcesContent":["<template lang=\"pug\">\n  .im-dialog(:class=\"{active, push}\")\n    router-link.im-dailog__pic(:to=\"{name: 'ProfileId', params: {id: info.last_message.recipient.id}}\")\n      img(:src=\"info.last_message.recipient.photo\" :alt=\"info.last_message.recipient.first_name\")\n    .im-dialog__info\n      router-link.im-dialog__name(:to=\"{name: 'ProfileId', params: {id: info.last_message.recipient.id}}\") {{info.last_message.recipient.first_name + ' ' + info.last_message.recipient.last_name}}\n      span.user-status(:class=\"{online}\") {{statusText}}\n    .im-dialog__content\n      p.im-dialog__last\n        span.im-dialog__last-me(v-if=\"me\") Вы: \n        | {{info.last_message.message_text}}\n      span.im-dialog__time {{info.last_message.time | moment('from')}}\n    span.im-dialog__push(v-if=\"push > 0\") {{push}}\n</template>\n\n<script>\nimport moment from 'moment'\nexport default {\n  name: 'ImDialog',\n  props: {\n    active: Boolean,\n    push: Number,\n    online: Boolean,\n    me: Boolean,\n    info: Object\n  },\n  computed: {\n    statusText() {\n      return this.online\n        ? 'Онлайн'\n        : 'был в сети ' + moment(this.info.last_message.recipient.last_online_time).fromNow()\n    }\n  }\n}\n</script>\n\n<style lang=\"stylus\">\n@import '../../assets/stylus/base/vars.styl';\n\n.im-dialog {\n  display: flex;\n  align-items: center;\n  height: 100px;\n  position: relative;\n  padding: 0 6.38%;\n  z-index: 0;\n  cursor: pointer;\n\n  &:before {\n    content: '';\n    display: none;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    background-color: #F8FAFD;\n    z-index: -1;\n  }\n\n  &:after {\n    content: '';\n    display: block;\n    height: 1px;\n    width: 87.24%;\n    background-color: #E3E8EE;\n    position: absolute;\n    bottom: 0;\n    left: 50%;\n    transform: translateX(-50%);\n  }\n\n  &.push + &.active, &.active + &.push {\n    &:after {\n      display: none;\n    }\n  }\n\n  &.active {\n    &:after {\n      display: none;\n    }\n\n    &:before {\n      display: block;\n    }\n  }\n\n  &.push {\n    &:after {\n      display: none;\n    }\n\n    &:before {\n      display: block;\n      background-color: #E9F5EF;\n    }\n\n    .im-dialog__content {\n      max-width: 30%;\n    }\n\n    .im-dialog__time {\n      color: #7D9A8B;\n    }\n  }\n}\n\n.im-dailog__pic {\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  overflow: hidden;\n  margin-right: 15px;\n  flex: none;\n}\n\n.im-dialog__info {\n  width: 100%;\n  max-width: 27.11%;\n  min-width: 150px;\n  margin-right: 30px;\n\n  @media (max-width: breakpoint-xl) {\n    display: none;\n  }\n}\n\n.im-dialog__name {\n  font-size: 15px;\n  line-height: 22px;\n  color: steel-gray;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.im-dialog__content {\n  max-width: 37%;\n\n  @media (max-width: breakpoint-xl) {\n    display: none;\n  }\n}\n\n.im-dialog__last {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  font-size: 13px;\n  line-height: 18px;\n  letter-spacing: -0.003em;\n\n  &-me {\n    color: eucalypt;\n  }\n}\n\n.im-dialog__time {\n  color: #A4A4B8;\n  font-size: 13px;\n  line-height: 19px;\n}\n\n.im-dialog__push {\n  width: 27px;\n  height: 27px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 15px;\n  line-height: 27px;\n  font-weight: 600;\n  color: #fff;\n  background-color: #E65151;\n  margin-left: auto;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Im/Dialog.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"im-dialog\",class:{active: _vm.active, push: _vm.push}},[_c('router-link',{staticClass:\"im-dailog__pic\",attrs:{\"to\":{name: 'ProfileId', params: {id: _vm.info.last_message.recipient.id}}}},[_c('img',{attrs:{\"src\":_vm.info.last_message.recipient.photo,\"alt\":_vm.info.last_message.recipient.first_name}})]),_c('div',{staticClass:\"im-dialog__info\"},[_c('router-link',{staticClass:\"im-dialog__name\",attrs:{\"to\":{name: 'ProfileId', params: {id: _vm.info.last_message.recipient.id}}}},[_vm._v(_vm._s(_vm.info.last_message.recipient.first_name + ' ' + _vm.info.last_message.recipient.last_name))]),_c('span',{staticClass:\"user-status\",class:{online: _vm.online}},[_vm._v(_vm._s(_vm.statusText))])],1),_c('div',{staticClass:\"im-dialog__content\"},[_c('p',{staticClass:\"im-dialog__last\"},[(_vm.me)?_c('span',{staticClass:\"im-dialog__last-me\"},[_vm._v(\"Вы: \")]):_vm._e(),_vm._v(_vm._s(_vm.info.last_message.message_text))]),_c('span',{staticClass:\"im-dialog__time\"},[_vm._v(_vm._s(_vm._f(\"moment\")(_vm.info.last_message.time,'from')))])]),(_vm.push > 0)?_c('span',{staticClass:\"im-dialog__push\"},[_vm._v(_vm._s(_vm.push))]):_vm._e()],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0b6319d8\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Im/Dialog.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0b6319d8\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Dialog.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Dialog.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Dialog.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0b6319d8\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Dialog.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Im/Dialog.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n  .im-chat\n    .im-chat__user\n      router-link.im-chat__user-pic(:to=\"{name: 'ProfileId', params: {id: info.last_message.recipient.id}}\")\n        img(:src=\"info.last_message.recipient.photo\" :alt=\"info.last_message.recipient.first_name\")\n      router-link.im-chat__user-name(:to=\"{name: 'ProfileId', params: {id: info.last_message.recipient.id}}\") {{info.last_message.recipient.first_name + ' ' + info.last_message.recipient.last_name}}\n      span.user-status(:class=\"{online}\") {{statusText}}\n    .im-chat__message(ref=\"messageBlock\")\n      .im-chat__message-day(v-for=\"day in messages\" :key=\"day.date\")\n        h5.im-chat__message-title {{day.date | moment('DD MMMM YYYY')}}\n        .im-chat__message-block(v-for=\"mes in day.messages\" :key=\"mes.id\" :class=\"{me: mes.isSentByMe}\")\n          p.im-chat__message-text {{mes.message_text}}\n          span.im-chat__message-time {{mes.time | moment('hh:mm')}}\n    form.im-chat__enter(action=\"#\" @submit.prevent=\"onSubmitMessage\")\n      input.im-chat__enter-input(type=\"text\" placeholder=\"Ваше сообщение...\" v-model=\"mes\")\n</template>\n\n<script>\nimport moment from 'moment'\nimport { mapActions } from 'vuex'\nexport default {\n  name: 'ImChat',\n  props: {\n    info: Object,\n    messages: Array,\n    online: Boolean\n  },\n  data: () => ({\n    mes: ''\n  }),\n  computed: {\n    statusText() {\n      return this.online\n        ? 'Онлайн'\n        : 'был в сети ' + moment(this.info.last_message.recipient.last_online_time).fromNow()\n    }\n  },\n  methods: {\n    ...mapActions('profile/dialogs', ['postMessage']),\n    onSubmitMessage() {\n      this.postMessage({ id: this.info.id, message_text: this.mes })\n      this.mes = ''\n    }\n  },\n  mounted() {\n    this.$refs.messageBlock.scrollTop = this.$refs.messageBlock.scrollHeight\n  }\n}\n</script>\n\n<style lang=\"stylus\">\n@import '../../assets/stylus/base/vars.styl';\n\n.im-chat {\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  height: 100%;\n}\n\n.im-chat__user {\n  border-bottom: 1px solid #E3E8EE;\n  display: flex;\n  align-items: center;\n  height: 60px;\n  padding: 0 40px;\n  font-size: 13px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  background-color: #F8FAFD;\n}\n\n.im-chat__user-pic {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  overflow: hidden;\n  margin-right: 10px;\n}\n\n.im-chat__user-name {\n  font-weight: 600;\n  color: steel-gray;\n  margin-right: auto;\n}\n\n.im-chat__user-status {\n  color: #9EA4AD;\n\n  &.online {\n    color: eucalypt;\n  }\n}\n\n.im-chat__message {\n  padding: 80px 40px 50px;\n  width: 100%;\n  overflow-y: scroll;\n  height: 100%;\n}\n\n.im-chat__message-day {\n  &+& {\n    margin-top: 50px;\n  }\n}\n\n.im-chat__message-title {\n  color: #8A94A4;\n  font-size: 15px;\n  margin-bottom: 55px;\n  text-align: center;\n  display: block;\n  width: 100%;\n}\n\n.im-chat__message-block {\n  display: flex;\n  align-items: center;\n  max-width: 460px;\n\n  &+& {\n    margin-top: 20px;\n  }\n\n  &.me + & {\n    margin-top: 30px;\n  }\n\n  &.me {\n    flex-direction: row-reverse;\n    max-width: 450px;\n    margin-left: auto;\n\n    .im-chat__message-text {\n      background-color: eucalypt;\n      color: #fff;\n      box-shadow: 0px 4px 15px #D4E8DD;\n    }\n\n    .im-chat__message-time {\n      margin-right: 15px;\n      margin-left: 0;\n    }\n  }\n}\n\n.im-chat__message-text {\n  background-color: #FFFFFF;\n  box-shadow: 0px 4px 15px #EFF1F6;\n  border-radius: 20px;\n  padding: 15px 20px;\n  color: steel-gray;\n  font-size: 15px;\n  line-height: 23px;\n}\n\n.im-chat__message-time {\n  font-size: 13px;\n  color: #BAC3D0;\n  margin-left: 15px;\n}\n\n.im-chat__enter {\n  display: block;\n  width: 100%;\n}\n\n.im-chat__enter-input {\n  width: 100%;\n  background-color: #fff;\n  padding: 0 40px;\n  font-size: 15px;\n  color: steel-gray;\n  height: 60px;\n\n  &::placeholder {\n    color: #B0B0BC;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Im/Chat.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"im-chat\"},[_c('div',{staticClass:\"im-chat__user\"},[_c('router-link',{staticClass:\"im-chat__user-pic\",attrs:{\"to\":{name: 'ProfileId', params: {id: _vm.info.last_message.recipient.id}}}},[_c('img',{attrs:{\"src\":_vm.info.last_message.recipient.photo,\"alt\":_vm.info.last_message.recipient.first_name}})]),_c('router-link',{staticClass:\"im-chat__user-name\",attrs:{\"to\":{name: 'ProfileId', params: {id: _vm.info.last_message.recipient.id}}}},[_vm._v(_vm._s(_vm.info.last_message.recipient.first_name + ' ' + _vm.info.last_message.recipient.last_name))]),_c('span',{staticClass:\"user-status\",class:{online: _vm.online}},[_vm._v(_vm._s(_vm.statusText))])],1),_c('div',{ref:\"messageBlock\",staticClass:\"im-chat__message\"},_vm._l((_vm.messages),function(day){return _c('div',{key:day.date,staticClass:\"im-chat__message-day\"},[_c('h5',{staticClass:\"im-chat__message-title\"},[_vm._v(_vm._s(_vm._f(\"moment\")(day.date,'DD MMMM YYYY')))]),_vm._l((day.messages),function(mes){return _c('div',{key:mes.id,staticClass:\"im-chat__message-block\",class:{me: mes.isSentByMe}},[_c('p',{staticClass:\"im-chat__message-text\"},[_vm._v(_vm._s(mes.message_text))]),_c('span',{staticClass:\"im-chat__message-time\"},[_vm._v(_vm._s(_vm._f(\"moment\")(mes.time,'hh:mm')))])])})],2)}),0),_c('form',{staticClass:\"im-chat__enter\",attrs:{\"action\":\"#\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmitMessage($event)}}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.mes),expression:\"mes\"}],staticClass:\"im-chat__enter-input\",attrs:{\"type\":\"text\",\"placeholder\":\"Ваше сообщение...\"},domProps:{\"value\":(_vm.mes)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.mes=$event.target.value}}})])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-74a07cfd\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Im/Chat.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-74a07cfd\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Chat.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Chat.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Chat.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-74a07cfd\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Chat.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Im/Chat.vue\n// module id = null\n// module chunks = ","<template lang=\"pug\">\n  .im\n    .im__dialogs\n      im-dialog(v-for=\"dialog in dialogs\"\n      :key=\"dialog.id\"\n      :info=\"dialog\"\n      :push=\"countPush(dialog.unread_count)\"\n      :me=\"dialog.last_message.isSentByMe\"\n      :active=\"activeDialog && dialog.id === activeDialog.id\"\n      :online=\"checkOnlineUser(dialog.last_message.recipient.last_online_time)\"\n      @click.native=\"clickOnDialog(dialog.id)\")\n    .im__chat(v-if=\"activeDialog\")\n      im-chat(:info=\"activeDialog\" :messages=\"getMessages\"\n      :online=\"checkOnlineUser(activeDialog.last_message.recipient.last_online_time)\" )\n</template>\n\n<script>\nimport moment from 'moment'\nimport { mapGetters, mapActions } from 'vuex'\nimport ImDialog from '@/components/Im/Dialog'\nimport ImChat from '@/components/Im/Chat'\nexport default {\n  name: 'Im',\n  components: { ImDialog, ImChat },\n  // data: () => ({\n  //   intervalForMessages: null\n  // }),\n  computed: {\n    ...mapGetters('profile/dialogs', ['getMessages', 'activeDialog', 'dialogs', 'dialogsLoaded']),\n  },\n  methods: {\n    ...mapActions('profile/dialogs', ['apiDialogs', 'dialogsMessages', 'switchDialog', 'closeDialog']),\n    countPush(unread) {\n      return unread > 0 ? unread : null\n    },\n    checkOnlineUser(time) {\n      return moment().diff(moment(time), 'seconds') <= 60\n    },\n    clickOnDialog(dialogId) {\n      this.$router.push({ name: 'Im', query: { activeDialog: dialogId } })\n    },\n    selectDialogByRoute(route, vm) {\n      if (route.query.activeDialog) {\n          vm.switchDialog(route.query.activeDialog);\n      } else if (vm.dialogs.length > 0) {\n          vm.$router.push({ name: 'Im', query: { activeDialog: vm.dialogs[0].id } })\n      } else {\n        console.log(\"No dialogs at all\")\n      }\n    }\n  },\n  beforeRouteEnter(to, from, next) {\n    next(async vm => {\n      if (!vm.dialogsLoaded) {\n        await vm.apiDialogs(vm.to)\n      }\n      vm.selectDialogByRoute(to, vm);\n    })\n  },\n  beforeRouteUpdate(to, from, next) {\n    this.selectDialogByRoute(to, this)\n    next();\n  },\n  beforeDestroy () {\n    this.closeDialog()\n  }\n}\n</script>\n\n<style lang=\"stylus\">\n@import '../../assets/stylus/base/vars.styl';\n\n.im {\n  display: flex;\n  height: 'calc(100vh - %s)' % header-height;\n}\n\n.im__dialogs {\n  width: 100%;\n  max-width: 39.13%;\n  overflow-y: auto;\n  max-height: 100%;\n  height: 100%;\n  background-color: #F2F5F9;\n\n  @media (max-width: breakpoint-xl) {\n    max-width: 120px;\n  }\n}\n\n.im__chat {\n  width: 100%;\n  flex: auto;\n  height: 100%;\n  background-color: #F8FAFD;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/User/Im.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"im\"},[_c('div',{staticClass:\"im__dialogs\"},_vm._l((_vm.dialogs),function(dialog){return _c('im-dialog',{key:dialog.id,attrs:{\"info\":dialog,\"push\":_vm.countPush(dialog.unread_count),\"me\":dialog.last_message.isSentByMe,\"active\":_vm.activeDialog && dialog.id === _vm.activeDialog.id,\"online\":_vm.checkOnlineUser(dialog.last_message.recipient.last_online_time)},nativeOn:{\"click\":function($event){return _vm.clickOnDialog(dialog.id)}}})}),1),(_vm.activeDialog)?_c('div',{staticClass:\"im__chat\"},[_c('im-chat',{attrs:{\"info\":_vm.activeDialog,\"messages\":_vm.getMessages,\"online\":_vm.checkOnlineUser(_vm.activeDialog.last_message.recipient.last_online_time)}})],1):_vm._e()])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-58e949fe\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/User/Im.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-58e949fe\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Im.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Im.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Im.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-58e949fe\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Im.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/User/Im.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}